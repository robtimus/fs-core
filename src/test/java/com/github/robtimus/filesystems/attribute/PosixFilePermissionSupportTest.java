/*
 * PosixFilePermissionSupportTest.java
 * Copyright 2016 Rob Spoor
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.github.robtimus.filesystems.attribute;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.params.provider.Arguments.arguments;
import java.nio.file.attribute.PosixFilePermission;
import java.nio.file.attribute.PosixFilePermissions;
import java.util.Arrays;
import java.util.Set;
import java.util.stream.Stream;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;

@SuppressWarnings("nls")
class PosixFilePermissionSupportTest {

    private static final PosixFilePermission[] ALL_PERMISSIONS = PosixFilePermission.values();

    static Stream<Arguments> testArguments() {
        Arguments[] arguments = {
                arguments(0000, PosixFilePermissions.fromString("---------")),
                arguments(0001, PosixFilePermissions.fromString("--------x")),
                arguments(0002, PosixFilePermissions.fromString("-------w-")),
                arguments(0003, PosixFilePermissions.fromString("-------wx")),
                arguments(0004, PosixFilePermissions.fromString("------r--")),
                arguments(0005, PosixFilePermissions.fromString("------r-x")),
                arguments(0006, PosixFilePermissions.fromString("------rw-")),
                arguments(0007, PosixFilePermissions.fromString("------rwx")),
                arguments(0010, PosixFilePermissions.fromString("-----x---")),
                arguments(0011, PosixFilePermissions.fromString("-----x--x")),
                arguments(0012, PosixFilePermissions.fromString("-----x-w-")),
                arguments(0013, PosixFilePermissions.fromString("-----x-wx")),
                arguments(0014, PosixFilePermissions.fromString("-----xr--")),
                arguments(0015, PosixFilePermissions.fromString("-----xr-x")),
                arguments(0016, PosixFilePermissions.fromString("-----xrw-")),
                arguments(0017, PosixFilePermissions.fromString("-----xrwx")),
                arguments(0020, PosixFilePermissions.fromString("----w----")),
                arguments(0021, PosixFilePermissions.fromString("----w---x")),
                arguments(0022, PosixFilePermissions.fromString("----w--w-")),
                arguments(0023, PosixFilePermissions.fromString("----w--wx")),
                arguments(0024, PosixFilePermissions.fromString("----w-r--")),
                arguments(0025, PosixFilePermissions.fromString("----w-r-x")),
                arguments(0026, PosixFilePermissions.fromString("----w-rw-")),
                arguments(0027, PosixFilePermissions.fromString("----w-rwx")),
                arguments(0030, PosixFilePermissions.fromString("----wx---")),
                arguments(0031, PosixFilePermissions.fromString("----wx--x")),
                arguments(0032, PosixFilePermissions.fromString("----wx-w-")),
                arguments(0033, PosixFilePermissions.fromString("----wx-wx")),
                arguments(0034, PosixFilePermissions.fromString("----wxr--")),
                arguments(0035, PosixFilePermissions.fromString("----wxr-x")),
                arguments(0036, PosixFilePermissions.fromString("----wxrw-")),
                arguments(0037, PosixFilePermissions.fromString("----wxrwx")),
                arguments(0040, PosixFilePermissions.fromString("---r-----")),
                arguments(0041, PosixFilePermissions.fromString("---r----x")),
                arguments(0042, PosixFilePermissions.fromString("---r---w-")),
                arguments(0043, PosixFilePermissions.fromString("---r---wx")),
                arguments(0044, PosixFilePermissions.fromString("---r--r--")),
                arguments(0045, PosixFilePermissions.fromString("---r--r-x")),
                arguments(0046, PosixFilePermissions.fromString("---r--rw-")),
                arguments(0047, PosixFilePermissions.fromString("---r--rwx")),
                arguments(0050, PosixFilePermissions.fromString("---r-x---")),
                arguments(0051, PosixFilePermissions.fromString("---r-x--x")),
                arguments(0052, PosixFilePermissions.fromString("---r-x-w-")),
                arguments(0053, PosixFilePermissions.fromString("---r-x-wx")),
                arguments(0054, PosixFilePermissions.fromString("---r-xr--")),
                arguments(0055, PosixFilePermissions.fromString("---r-xr-x")),
                arguments(0056, PosixFilePermissions.fromString("---r-xrw-")),
                arguments(0057, PosixFilePermissions.fromString("---r-xrwx")),
                arguments(0060, PosixFilePermissions.fromString("---rw----")),
                arguments(0061, PosixFilePermissions.fromString("---rw---x")),
                arguments(0062, PosixFilePermissions.fromString("---rw--w-")),
                arguments(0063, PosixFilePermissions.fromString("---rw--wx")),
                arguments(0064, PosixFilePermissions.fromString("---rw-r--")),
                arguments(0065, PosixFilePermissions.fromString("---rw-r-x")),
                arguments(0066, PosixFilePermissions.fromString("---rw-rw-")),
                arguments(0067, PosixFilePermissions.fromString("---rw-rwx")),
                arguments(0070, PosixFilePermissions.fromString("---rwx---")),
                arguments(0071, PosixFilePermissions.fromString("---rwx--x")),
                arguments(0072, PosixFilePermissions.fromString("---rwx-w-")),
                arguments(0073, PosixFilePermissions.fromString("---rwx-wx")),
                arguments(0074, PosixFilePermissions.fromString("---rwxr--")),
                arguments(0075, PosixFilePermissions.fromString("---rwxr-x")),
                arguments(0076, PosixFilePermissions.fromString("---rwxrw-")),
                arguments(0077, PosixFilePermissions.fromString("---rwxrwx")),
                arguments(0100, PosixFilePermissions.fromString("--x------")),
                arguments(0101, PosixFilePermissions.fromString("--x-----x")),
                arguments(0102, PosixFilePermissions.fromString("--x----w-")),
                arguments(0103, PosixFilePermissions.fromString("--x----wx")),
                arguments(0104, PosixFilePermissions.fromString("--x---r--")),
                arguments(0105, PosixFilePermissions.fromString("--x---r-x")),
                arguments(0106, PosixFilePermissions.fromString("--x---rw-")),
                arguments(0107, PosixFilePermissions.fromString("--x---rwx")),
                arguments(0110, PosixFilePermissions.fromString("--x--x---")),
                arguments(0111, PosixFilePermissions.fromString("--x--x--x")),
                arguments(0112, PosixFilePermissions.fromString("--x--x-w-")),
                arguments(0113, PosixFilePermissions.fromString("--x--x-wx")),
                arguments(0114, PosixFilePermissions.fromString("--x--xr--")),
                arguments(0115, PosixFilePermissions.fromString("--x--xr-x")),
                arguments(0116, PosixFilePermissions.fromString("--x--xrw-")),
                arguments(0117, PosixFilePermissions.fromString("--x--xrwx")),
                arguments(0120, PosixFilePermissions.fromString("--x-w----")),
                arguments(0121, PosixFilePermissions.fromString("--x-w---x")),
                arguments(0122, PosixFilePermissions.fromString("--x-w--w-")),
                arguments(0123, PosixFilePermissions.fromString("--x-w--wx")),
                arguments(0124, PosixFilePermissions.fromString("--x-w-r--")),
                arguments(0125, PosixFilePermissions.fromString("--x-w-r-x")),
                arguments(0126, PosixFilePermissions.fromString("--x-w-rw-")),
                arguments(0127, PosixFilePermissions.fromString("--x-w-rwx")),
                arguments(0130, PosixFilePermissions.fromString("--x-wx---")),
                arguments(0131, PosixFilePermissions.fromString("--x-wx--x")),
                arguments(0132, PosixFilePermissions.fromString("--x-wx-w-")),
                arguments(0133, PosixFilePermissions.fromString("--x-wx-wx")),
                arguments(0134, PosixFilePermissions.fromString("--x-wxr--")),
                arguments(0135, PosixFilePermissions.fromString("--x-wxr-x")),
                arguments(0136, PosixFilePermissions.fromString("--x-wxrw-")),
                arguments(0137, PosixFilePermissions.fromString("--x-wxrwx")),
                arguments(0140, PosixFilePermissions.fromString("--xr-----")),
                arguments(0141, PosixFilePermissions.fromString("--xr----x")),
                arguments(0142, PosixFilePermissions.fromString("--xr---w-")),
                arguments(0143, PosixFilePermissions.fromString("--xr---wx")),
                arguments(0144, PosixFilePermissions.fromString("--xr--r--")),
                arguments(0145, PosixFilePermissions.fromString("--xr--r-x")),
                arguments(0146, PosixFilePermissions.fromString("--xr--rw-")),
                arguments(0147, PosixFilePermissions.fromString("--xr--rwx")),
                arguments(0150, PosixFilePermissions.fromString("--xr-x---")),
                arguments(0151, PosixFilePermissions.fromString("--xr-x--x")),
                arguments(0152, PosixFilePermissions.fromString("--xr-x-w-")),
                arguments(0153, PosixFilePermissions.fromString("--xr-x-wx")),
                arguments(0154, PosixFilePermissions.fromString("--xr-xr--")),
                arguments(0155, PosixFilePermissions.fromString("--xr-xr-x")),
                arguments(0156, PosixFilePermissions.fromString("--xr-xrw-")),
                arguments(0157, PosixFilePermissions.fromString("--xr-xrwx")),
                arguments(0160, PosixFilePermissions.fromString("--xrw----")),
                arguments(0161, PosixFilePermissions.fromString("--xrw---x")),
                arguments(0162, PosixFilePermissions.fromString("--xrw--w-")),
                arguments(0163, PosixFilePermissions.fromString("--xrw--wx")),
                arguments(0164, PosixFilePermissions.fromString("--xrw-r--")),
                arguments(0165, PosixFilePermissions.fromString("--xrw-r-x")),
                arguments(0166, PosixFilePermissions.fromString("--xrw-rw-")),
                arguments(0167, PosixFilePermissions.fromString("--xrw-rwx")),
                arguments(0170, PosixFilePermissions.fromString("--xrwx---")),
                arguments(0171, PosixFilePermissions.fromString("--xrwx--x")),
                arguments(0172, PosixFilePermissions.fromString("--xrwx-w-")),
                arguments(0173, PosixFilePermissions.fromString("--xrwx-wx")),
                arguments(0174, PosixFilePermissions.fromString("--xrwxr--")),
                arguments(0175, PosixFilePermissions.fromString("--xrwxr-x")),
                arguments(0176, PosixFilePermissions.fromString("--xrwxrw-")),
                arguments(0177, PosixFilePermissions.fromString("--xrwxrwx")),
                arguments(0200, PosixFilePermissions.fromString("-w-------")),
                arguments(0201, PosixFilePermissions.fromString("-w------x")),
                arguments(0202, PosixFilePermissions.fromString("-w-----w-")),
                arguments(0203, PosixFilePermissions.fromString("-w-----wx")),
                arguments(0204, PosixFilePermissions.fromString("-w----r--")),
                arguments(0205, PosixFilePermissions.fromString("-w----r-x")),
                arguments(0206, PosixFilePermissions.fromString("-w----rw-")),
                arguments(0207, PosixFilePermissions.fromString("-w----rwx")),
                arguments(0210, PosixFilePermissions.fromString("-w---x---")),
                arguments(0211, PosixFilePermissions.fromString("-w---x--x")),
                arguments(0212, PosixFilePermissions.fromString("-w---x-w-")),
                arguments(0213, PosixFilePermissions.fromString("-w---x-wx")),
                arguments(0214, PosixFilePermissions.fromString("-w---xr--")),
                arguments(0215, PosixFilePermissions.fromString("-w---xr-x")),
                arguments(0216, PosixFilePermissions.fromString("-w---xrw-")),
                arguments(0217, PosixFilePermissions.fromString("-w---xrwx")),
                arguments(0220, PosixFilePermissions.fromString("-w--w----")),
                arguments(0221, PosixFilePermissions.fromString("-w--w---x")),
                arguments(0222, PosixFilePermissions.fromString("-w--w--w-")),
                arguments(0223, PosixFilePermissions.fromString("-w--w--wx")),
                arguments(0224, PosixFilePermissions.fromString("-w--w-r--")),
                arguments(0225, PosixFilePermissions.fromString("-w--w-r-x")),
                arguments(0226, PosixFilePermissions.fromString("-w--w-rw-")),
                arguments(0227, PosixFilePermissions.fromString("-w--w-rwx")),
                arguments(0230, PosixFilePermissions.fromString("-w--wx---")),
                arguments(0231, PosixFilePermissions.fromString("-w--wx--x")),
                arguments(0232, PosixFilePermissions.fromString("-w--wx-w-")),
                arguments(0233, PosixFilePermissions.fromString("-w--wx-wx")),
                arguments(0234, PosixFilePermissions.fromString("-w--wxr--")),
                arguments(0235, PosixFilePermissions.fromString("-w--wxr-x")),
                arguments(0236, PosixFilePermissions.fromString("-w--wxrw-")),
                arguments(0237, PosixFilePermissions.fromString("-w--wxrwx")),
                arguments(0240, PosixFilePermissions.fromString("-w-r-----")),
                arguments(0241, PosixFilePermissions.fromString("-w-r----x")),
                arguments(0242, PosixFilePermissions.fromString("-w-r---w-")),
                arguments(0243, PosixFilePermissions.fromString("-w-r---wx")),
                arguments(0244, PosixFilePermissions.fromString("-w-r--r--")),
                arguments(0245, PosixFilePermissions.fromString("-w-r--r-x")),
                arguments(0246, PosixFilePermissions.fromString("-w-r--rw-")),
                arguments(0247, PosixFilePermissions.fromString("-w-r--rwx")),
                arguments(0250, PosixFilePermissions.fromString("-w-r-x---")),
                arguments(0251, PosixFilePermissions.fromString("-w-r-x--x")),
                arguments(0252, PosixFilePermissions.fromString("-w-r-x-w-")),
                arguments(0253, PosixFilePermissions.fromString("-w-r-x-wx")),
                arguments(0254, PosixFilePermissions.fromString("-w-r-xr--")),
                arguments(0255, PosixFilePermissions.fromString("-w-r-xr-x")),
                arguments(0256, PosixFilePermissions.fromString("-w-r-xrw-")),
                arguments(0257, PosixFilePermissions.fromString("-w-r-xrwx")),
                arguments(0260, PosixFilePermissions.fromString("-w-rw----")),
                arguments(0261, PosixFilePermissions.fromString("-w-rw---x")),
                arguments(0262, PosixFilePermissions.fromString("-w-rw--w-")),
                arguments(0263, PosixFilePermissions.fromString("-w-rw--wx")),
                arguments(0264, PosixFilePermissions.fromString("-w-rw-r--")),
                arguments(0265, PosixFilePermissions.fromString("-w-rw-r-x")),
                arguments(0266, PosixFilePermissions.fromString("-w-rw-rw-")),
                arguments(0267, PosixFilePermissions.fromString("-w-rw-rwx")),
                arguments(0270, PosixFilePermissions.fromString("-w-rwx---")),
                arguments(0271, PosixFilePermissions.fromString("-w-rwx--x")),
                arguments(0272, PosixFilePermissions.fromString("-w-rwx-w-")),
                arguments(0273, PosixFilePermissions.fromString("-w-rwx-wx")),
                arguments(0274, PosixFilePermissions.fromString("-w-rwxr--")),
                arguments(0275, PosixFilePermissions.fromString("-w-rwxr-x")),
                arguments(0276, PosixFilePermissions.fromString("-w-rwxrw-")),
                arguments(0277, PosixFilePermissions.fromString("-w-rwxrwx")),
                arguments(0300, PosixFilePermissions.fromString("-wx------")),
                arguments(0301, PosixFilePermissions.fromString("-wx-----x")),
                arguments(0302, PosixFilePermissions.fromString("-wx----w-")),
                arguments(0303, PosixFilePermissions.fromString("-wx----wx")),
                arguments(0304, PosixFilePermissions.fromString("-wx---r--")),
                arguments(0305, PosixFilePermissions.fromString("-wx---r-x")),
                arguments(0306, PosixFilePermissions.fromString("-wx---rw-")),
                arguments(0307, PosixFilePermissions.fromString("-wx---rwx")),
                arguments(0310, PosixFilePermissions.fromString("-wx--x---")),
                arguments(0311, PosixFilePermissions.fromString("-wx--x--x")),
                arguments(0312, PosixFilePermissions.fromString("-wx--x-w-")),
                arguments(0313, PosixFilePermissions.fromString("-wx--x-wx")),
                arguments(0314, PosixFilePermissions.fromString("-wx--xr--")),
                arguments(0315, PosixFilePermissions.fromString("-wx--xr-x")),
                arguments(0316, PosixFilePermissions.fromString("-wx--xrw-")),
                arguments(0317, PosixFilePermissions.fromString("-wx--xrwx")),
                arguments(0320, PosixFilePermissions.fromString("-wx-w----")),
                arguments(0321, PosixFilePermissions.fromString("-wx-w---x")),
                arguments(0322, PosixFilePermissions.fromString("-wx-w--w-")),
                arguments(0323, PosixFilePermissions.fromString("-wx-w--wx")),
                arguments(0324, PosixFilePermissions.fromString("-wx-w-r--")),
                arguments(0325, PosixFilePermissions.fromString("-wx-w-r-x")),
                arguments(0326, PosixFilePermissions.fromString("-wx-w-rw-")),
                arguments(0327, PosixFilePermissions.fromString("-wx-w-rwx")),
                arguments(0330, PosixFilePermissions.fromString("-wx-wx---")),
                arguments(0331, PosixFilePermissions.fromString("-wx-wx--x")),
                arguments(0332, PosixFilePermissions.fromString("-wx-wx-w-")),
                arguments(0333, PosixFilePermissions.fromString("-wx-wx-wx")),
                arguments(0334, PosixFilePermissions.fromString("-wx-wxr--")),
                arguments(0335, PosixFilePermissions.fromString("-wx-wxr-x")),
                arguments(0336, PosixFilePermissions.fromString("-wx-wxrw-")),
                arguments(0337, PosixFilePermissions.fromString("-wx-wxrwx")),
                arguments(0340, PosixFilePermissions.fromString("-wxr-----")),
                arguments(0341, PosixFilePermissions.fromString("-wxr----x")),
                arguments(0342, PosixFilePermissions.fromString("-wxr---w-")),
                arguments(0343, PosixFilePermissions.fromString("-wxr---wx")),
                arguments(0344, PosixFilePermissions.fromString("-wxr--r--")),
                arguments(0345, PosixFilePermissions.fromString("-wxr--r-x")),
                arguments(0346, PosixFilePermissions.fromString("-wxr--rw-")),
                arguments(0347, PosixFilePermissions.fromString("-wxr--rwx")),
                arguments(0350, PosixFilePermissions.fromString("-wxr-x---")),
                arguments(0351, PosixFilePermissions.fromString("-wxr-x--x")),
                arguments(0352, PosixFilePermissions.fromString("-wxr-x-w-")),
                arguments(0353, PosixFilePermissions.fromString("-wxr-x-wx")),
                arguments(0354, PosixFilePermissions.fromString("-wxr-xr--")),
                arguments(0355, PosixFilePermissions.fromString("-wxr-xr-x")),
                arguments(0356, PosixFilePermissions.fromString("-wxr-xrw-")),
                arguments(0357, PosixFilePermissions.fromString("-wxr-xrwx")),
                arguments(0360, PosixFilePermissions.fromString("-wxrw----")),
                arguments(0361, PosixFilePermissions.fromString("-wxrw---x")),
                arguments(0362, PosixFilePermissions.fromString("-wxrw--w-")),
                arguments(0363, PosixFilePermissions.fromString("-wxrw--wx")),
                arguments(0364, PosixFilePermissions.fromString("-wxrw-r--")),
                arguments(0365, PosixFilePermissions.fromString("-wxrw-r-x")),
                arguments(0366, PosixFilePermissions.fromString("-wxrw-rw-")),
                arguments(0367, PosixFilePermissions.fromString("-wxrw-rwx")),
                arguments(0370, PosixFilePermissions.fromString("-wxrwx---")),
                arguments(0371, PosixFilePermissions.fromString("-wxrwx--x")),
                arguments(0372, PosixFilePermissions.fromString("-wxrwx-w-")),
                arguments(0373, PosixFilePermissions.fromString("-wxrwx-wx")),
                arguments(0374, PosixFilePermissions.fromString("-wxrwxr--")),
                arguments(0375, PosixFilePermissions.fromString("-wxrwxr-x")),
                arguments(0376, PosixFilePermissions.fromString("-wxrwxrw-")),
                arguments(0377, PosixFilePermissions.fromString("-wxrwxrwx")),
                arguments(0400, PosixFilePermissions.fromString("r--------")),
                arguments(0401, PosixFilePermissions.fromString("r-------x")),
                arguments(0402, PosixFilePermissions.fromString("r------w-")),
                arguments(0403, PosixFilePermissions.fromString("r------wx")),
                arguments(0404, PosixFilePermissions.fromString("r-----r--")),
                arguments(0405, PosixFilePermissions.fromString("r-----r-x")),
                arguments(0406, PosixFilePermissions.fromString("r-----rw-")),
                arguments(0407, PosixFilePermissions.fromString("r-----rwx")),
                arguments(0410, PosixFilePermissions.fromString("r----x---")),
                arguments(0411, PosixFilePermissions.fromString("r----x--x")),
                arguments(0412, PosixFilePermissions.fromString("r----x-w-")),
                arguments(0413, PosixFilePermissions.fromString("r----x-wx")),
                arguments(0414, PosixFilePermissions.fromString("r----xr--")),
                arguments(0415, PosixFilePermissions.fromString("r----xr-x")),
                arguments(0416, PosixFilePermissions.fromString("r----xrw-")),
                arguments(0417, PosixFilePermissions.fromString("r----xrwx")),
                arguments(0420, PosixFilePermissions.fromString("r---w----")),
                arguments(0421, PosixFilePermissions.fromString("r---w---x")),
                arguments(0422, PosixFilePermissions.fromString("r---w--w-")),
                arguments(0423, PosixFilePermissions.fromString("r---w--wx")),
                arguments(0424, PosixFilePermissions.fromString("r---w-r--")),
                arguments(0425, PosixFilePermissions.fromString("r---w-r-x")),
                arguments(0426, PosixFilePermissions.fromString("r---w-rw-")),
                arguments(0427, PosixFilePermissions.fromString("r---w-rwx")),
                arguments(0430, PosixFilePermissions.fromString("r---wx---")),
                arguments(0431, PosixFilePermissions.fromString("r---wx--x")),
                arguments(0432, PosixFilePermissions.fromString("r---wx-w-")),
                arguments(0433, PosixFilePermissions.fromString("r---wx-wx")),
                arguments(0434, PosixFilePermissions.fromString("r---wxr--")),
                arguments(0435, PosixFilePermissions.fromString("r---wxr-x")),
                arguments(0436, PosixFilePermissions.fromString("r---wxrw-")),
                arguments(0437, PosixFilePermissions.fromString("r---wxrwx")),
                arguments(0440, PosixFilePermissions.fromString("r--r-----")),
                arguments(0441, PosixFilePermissions.fromString("r--r----x")),
                arguments(0442, PosixFilePermissions.fromString("r--r---w-")),
                arguments(0443, PosixFilePermissions.fromString("r--r---wx")),
                arguments(0444, PosixFilePermissions.fromString("r--r--r--")),
                arguments(0445, PosixFilePermissions.fromString("r--r--r-x")),
                arguments(0446, PosixFilePermissions.fromString("r--r--rw-")),
                arguments(0447, PosixFilePermissions.fromString("r--r--rwx")),
                arguments(0450, PosixFilePermissions.fromString("r--r-x---")),
                arguments(0451, PosixFilePermissions.fromString("r--r-x--x")),
                arguments(0452, PosixFilePermissions.fromString("r--r-x-w-")),
                arguments(0453, PosixFilePermissions.fromString("r--r-x-wx")),
                arguments(0454, PosixFilePermissions.fromString("r--r-xr--")),
                arguments(0455, PosixFilePermissions.fromString("r--r-xr-x")),
                arguments(0456, PosixFilePermissions.fromString("r--r-xrw-")),
                arguments(0457, PosixFilePermissions.fromString("r--r-xrwx")),
                arguments(0460, PosixFilePermissions.fromString("r--rw----")),
                arguments(0461, PosixFilePermissions.fromString("r--rw---x")),
                arguments(0462, PosixFilePermissions.fromString("r--rw--w-")),
                arguments(0463, PosixFilePermissions.fromString("r--rw--wx")),
                arguments(0464, PosixFilePermissions.fromString("r--rw-r--")),
                arguments(0465, PosixFilePermissions.fromString("r--rw-r-x")),
                arguments(0466, PosixFilePermissions.fromString("r--rw-rw-")),
                arguments(0467, PosixFilePermissions.fromString("r--rw-rwx")),
                arguments(0470, PosixFilePermissions.fromString("r--rwx---")),
                arguments(0471, PosixFilePermissions.fromString("r--rwx--x")),
                arguments(0472, PosixFilePermissions.fromString("r--rwx-w-")),
                arguments(0473, PosixFilePermissions.fromString("r--rwx-wx")),
                arguments(0474, PosixFilePermissions.fromString("r--rwxr--")),
                arguments(0475, PosixFilePermissions.fromString("r--rwxr-x")),
                arguments(0476, PosixFilePermissions.fromString("r--rwxrw-")),
                arguments(0477, PosixFilePermissions.fromString("r--rwxrwx")),
                arguments(0500, PosixFilePermissions.fromString("r-x------")),
                arguments(0501, PosixFilePermissions.fromString("r-x-----x")),
                arguments(0502, PosixFilePermissions.fromString("r-x----w-")),
                arguments(0503, PosixFilePermissions.fromString("r-x----wx")),
                arguments(0504, PosixFilePermissions.fromString("r-x---r--")),
                arguments(0505, PosixFilePermissions.fromString("r-x---r-x")),
                arguments(0506, PosixFilePermissions.fromString("r-x---rw-")),
                arguments(0507, PosixFilePermissions.fromString("r-x---rwx")),
                arguments(0510, PosixFilePermissions.fromString("r-x--x---")),
                arguments(0511, PosixFilePermissions.fromString("r-x--x--x")),
                arguments(0512, PosixFilePermissions.fromString("r-x--x-w-")),
                arguments(0513, PosixFilePermissions.fromString("r-x--x-wx")),
                arguments(0514, PosixFilePermissions.fromString("r-x--xr--")),
                arguments(0515, PosixFilePermissions.fromString("r-x--xr-x")),
                arguments(0516, PosixFilePermissions.fromString("r-x--xrw-")),
                arguments(0517, PosixFilePermissions.fromString("r-x--xrwx")),
                arguments(0520, PosixFilePermissions.fromString("r-x-w----")),
                arguments(0521, PosixFilePermissions.fromString("r-x-w---x")),
                arguments(0522, PosixFilePermissions.fromString("r-x-w--w-")),
                arguments(0523, PosixFilePermissions.fromString("r-x-w--wx")),
                arguments(0524, PosixFilePermissions.fromString("r-x-w-r--")),
                arguments(0525, PosixFilePermissions.fromString("r-x-w-r-x")),
                arguments(0526, PosixFilePermissions.fromString("r-x-w-rw-")),
                arguments(0527, PosixFilePermissions.fromString("r-x-w-rwx")),
                arguments(0530, PosixFilePermissions.fromString("r-x-wx---")),
                arguments(0531, PosixFilePermissions.fromString("r-x-wx--x")),
                arguments(0532, PosixFilePermissions.fromString("r-x-wx-w-")),
                arguments(0533, PosixFilePermissions.fromString("r-x-wx-wx")),
                arguments(0534, PosixFilePermissions.fromString("r-x-wxr--")),
                arguments(0535, PosixFilePermissions.fromString("r-x-wxr-x")),
                arguments(0536, PosixFilePermissions.fromString("r-x-wxrw-")),
                arguments(0537, PosixFilePermissions.fromString("r-x-wxrwx")),
                arguments(0540, PosixFilePermissions.fromString("r-xr-----")),
                arguments(0541, PosixFilePermissions.fromString("r-xr----x")),
                arguments(0542, PosixFilePermissions.fromString("r-xr---w-")),
                arguments(0543, PosixFilePermissions.fromString("r-xr---wx")),
                arguments(0544, PosixFilePermissions.fromString("r-xr--r--")),
                arguments(0545, PosixFilePermissions.fromString("r-xr--r-x")),
                arguments(0546, PosixFilePermissions.fromString("r-xr--rw-")),
                arguments(0547, PosixFilePermissions.fromString("r-xr--rwx")),
                arguments(0550, PosixFilePermissions.fromString("r-xr-x---")),
                arguments(0551, PosixFilePermissions.fromString("r-xr-x--x")),
                arguments(0552, PosixFilePermissions.fromString("r-xr-x-w-")),
                arguments(0553, PosixFilePermissions.fromString("r-xr-x-wx")),
                arguments(0554, PosixFilePermissions.fromString("r-xr-xr--")),
                arguments(0555, PosixFilePermissions.fromString("r-xr-xr-x")),
                arguments(0556, PosixFilePermissions.fromString("r-xr-xrw-")),
                arguments(0557, PosixFilePermissions.fromString("r-xr-xrwx")),
                arguments(0560, PosixFilePermissions.fromString("r-xrw----")),
                arguments(0561, PosixFilePermissions.fromString("r-xrw---x")),
                arguments(0562, PosixFilePermissions.fromString("r-xrw--w-")),
                arguments(0563, PosixFilePermissions.fromString("r-xrw--wx")),
                arguments(0564, PosixFilePermissions.fromString("r-xrw-r--")),
                arguments(0565, PosixFilePermissions.fromString("r-xrw-r-x")),
                arguments(0566, PosixFilePermissions.fromString("r-xrw-rw-")),
                arguments(0567, PosixFilePermissions.fromString("r-xrw-rwx")),
                arguments(0570, PosixFilePermissions.fromString("r-xrwx---")),
                arguments(0571, PosixFilePermissions.fromString("r-xrwx--x")),
                arguments(0572, PosixFilePermissions.fromString("r-xrwx-w-")),
                arguments(0573, PosixFilePermissions.fromString("r-xrwx-wx")),
                arguments(0574, PosixFilePermissions.fromString("r-xrwxr--")),
                arguments(0575, PosixFilePermissions.fromString("r-xrwxr-x")),
                arguments(0576, PosixFilePermissions.fromString("r-xrwxrw-")),
                arguments(0577, PosixFilePermissions.fromString("r-xrwxrwx")),
                arguments(0600, PosixFilePermissions.fromString("rw-------")),
                arguments(0601, PosixFilePermissions.fromString("rw------x")),
                arguments(0602, PosixFilePermissions.fromString("rw-----w-")),
                arguments(0603, PosixFilePermissions.fromString("rw-----wx")),
                arguments(0604, PosixFilePermissions.fromString("rw----r--")),
                arguments(0605, PosixFilePermissions.fromString("rw----r-x")),
                arguments(0606, PosixFilePermissions.fromString("rw----rw-")),
                arguments(0607, PosixFilePermissions.fromString("rw----rwx")),
                arguments(0610, PosixFilePermissions.fromString("rw---x---")),
                arguments(0611, PosixFilePermissions.fromString("rw---x--x")),
                arguments(0612, PosixFilePermissions.fromString("rw---x-w-")),
                arguments(0613, PosixFilePermissions.fromString("rw---x-wx")),
                arguments(0614, PosixFilePermissions.fromString("rw---xr--")),
                arguments(0615, PosixFilePermissions.fromString("rw---xr-x")),
                arguments(0616, PosixFilePermissions.fromString("rw---xrw-")),
                arguments(0617, PosixFilePermissions.fromString("rw---xrwx")),
                arguments(0620, PosixFilePermissions.fromString("rw--w----")),
                arguments(0621, PosixFilePermissions.fromString("rw--w---x")),
                arguments(0622, PosixFilePermissions.fromString("rw--w--w-")),
                arguments(0623, PosixFilePermissions.fromString("rw--w--wx")),
                arguments(0624, PosixFilePermissions.fromString("rw--w-r--")),
                arguments(0625, PosixFilePermissions.fromString("rw--w-r-x")),
                arguments(0626, PosixFilePermissions.fromString("rw--w-rw-")),
                arguments(0627, PosixFilePermissions.fromString("rw--w-rwx")),
                arguments(0630, PosixFilePermissions.fromString("rw--wx---")),
                arguments(0631, PosixFilePermissions.fromString("rw--wx--x")),
                arguments(0632, PosixFilePermissions.fromString("rw--wx-w-")),
                arguments(0633, PosixFilePermissions.fromString("rw--wx-wx")),
                arguments(0634, PosixFilePermissions.fromString("rw--wxr--")),
                arguments(0635, PosixFilePermissions.fromString("rw--wxr-x")),
                arguments(0636, PosixFilePermissions.fromString("rw--wxrw-")),
                arguments(0637, PosixFilePermissions.fromString("rw--wxrwx")),
                arguments(0640, PosixFilePermissions.fromString("rw-r-----")),
                arguments(0641, PosixFilePermissions.fromString("rw-r----x")),
                arguments(0642, PosixFilePermissions.fromString("rw-r---w-")),
                arguments(0643, PosixFilePermissions.fromString("rw-r---wx")),
                arguments(0644, PosixFilePermissions.fromString("rw-r--r--")),
                arguments(0645, PosixFilePermissions.fromString("rw-r--r-x")),
                arguments(0646, PosixFilePermissions.fromString("rw-r--rw-")),
                arguments(0647, PosixFilePermissions.fromString("rw-r--rwx")),
                arguments(0650, PosixFilePermissions.fromString("rw-r-x---")),
                arguments(0651, PosixFilePermissions.fromString("rw-r-x--x")),
                arguments(0652, PosixFilePermissions.fromString("rw-r-x-w-")),
                arguments(0653, PosixFilePermissions.fromString("rw-r-x-wx")),
                arguments(0654, PosixFilePermissions.fromString("rw-r-xr--")),
                arguments(0655, PosixFilePermissions.fromString("rw-r-xr-x")),
                arguments(0656, PosixFilePermissions.fromString("rw-r-xrw-")),
                arguments(0657, PosixFilePermissions.fromString("rw-r-xrwx")),
                arguments(0660, PosixFilePermissions.fromString("rw-rw----")),
                arguments(0661, PosixFilePermissions.fromString("rw-rw---x")),
                arguments(0662, PosixFilePermissions.fromString("rw-rw--w-")),
                arguments(0663, PosixFilePermissions.fromString("rw-rw--wx")),
                arguments(0664, PosixFilePermissions.fromString("rw-rw-r--")),
                arguments(0665, PosixFilePermissions.fromString("rw-rw-r-x")),
                arguments(0666, PosixFilePermissions.fromString("rw-rw-rw-")),
                arguments(0667, PosixFilePermissions.fromString("rw-rw-rwx")),
                arguments(0670, PosixFilePermissions.fromString("rw-rwx---")),
                arguments(0671, PosixFilePermissions.fromString("rw-rwx--x")),
                arguments(0672, PosixFilePermissions.fromString("rw-rwx-w-")),
                arguments(0673, PosixFilePermissions.fromString("rw-rwx-wx")),
                arguments(0674, PosixFilePermissions.fromString("rw-rwxr--")),
                arguments(0675, PosixFilePermissions.fromString("rw-rwxr-x")),
                arguments(0676, PosixFilePermissions.fromString("rw-rwxrw-")),
                arguments(0677, PosixFilePermissions.fromString("rw-rwxrwx")),
                arguments(0700, PosixFilePermissions.fromString("rwx------")),
                arguments(0701, PosixFilePermissions.fromString("rwx-----x")),
                arguments(0702, PosixFilePermissions.fromString("rwx----w-")),
                arguments(0703, PosixFilePermissions.fromString("rwx----wx")),
                arguments(0704, PosixFilePermissions.fromString("rwx---r--")),
                arguments(0705, PosixFilePermissions.fromString("rwx---r-x")),
                arguments(0706, PosixFilePermissions.fromString("rwx---rw-")),
                arguments(0707, PosixFilePermissions.fromString("rwx---rwx")),
                arguments(0710, PosixFilePermissions.fromString("rwx--x---")),
                arguments(0711, PosixFilePermissions.fromString("rwx--x--x")),
                arguments(0712, PosixFilePermissions.fromString("rwx--x-w-")),
                arguments(0713, PosixFilePermissions.fromString("rwx--x-wx")),
                arguments(0714, PosixFilePermissions.fromString("rwx--xr--")),
                arguments(0715, PosixFilePermissions.fromString("rwx--xr-x")),
                arguments(0716, PosixFilePermissions.fromString("rwx--xrw-")),
                arguments(0717, PosixFilePermissions.fromString("rwx--xrwx")),
                arguments(0720, PosixFilePermissions.fromString("rwx-w----")),
                arguments(0721, PosixFilePermissions.fromString("rwx-w---x")),
                arguments(0722, PosixFilePermissions.fromString("rwx-w--w-")),
                arguments(0723, PosixFilePermissions.fromString("rwx-w--wx")),
                arguments(0724, PosixFilePermissions.fromString("rwx-w-r--")),
                arguments(0725, PosixFilePermissions.fromString("rwx-w-r-x")),
                arguments(0726, PosixFilePermissions.fromString("rwx-w-rw-")),
                arguments(0727, PosixFilePermissions.fromString("rwx-w-rwx")),
                arguments(0730, PosixFilePermissions.fromString("rwx-wx---")),
                arguments(0731, PosixFilePermissions.fromString("rwx-wx--x")),
                arguments(0732, PosixFilePermissions.fromString("rwx-wx-w-")),
                arguments(0733, PosixFilePermissions.fromString("rwx-wx-wx")),
                arguments(0734, PosixFilePermissions.fromString("rwx-wxr--")),
                arguments(0735, PosixFilePermissions.fromString("rwx-wxr-x")),
                arguments(0736, PosixFilePermissions.fromString("rwx-wxrw-")),
                arguments(0737, PosixFilePermissions.fromString("rwx-wxrwx")),
                arguments(0740, PosixFilePermissions.fromString("rwxr-----")),
                arguments(0741, PosixFilePermissions.fromString("rwxr----x")),
                arguments(0742, PosixFilePermissions.fromString("rwxr---w-")),
                arguments(0743, PosixFilePermissions.fromString("rwxr---wx")),
                arguments(0744, PosixFilePermissions.fromString("rwxr--r--")),
                arguments(0745, PosixFilePermissions.fromString("rwxr--r-x")),
                arguments(0746, PosixFilePermissions.fromString("rwxr--rw-")),
                arguments(0747, PosixFilePermissions.fromString("rwxr--rwx")),
                arguments(0750, PosixFilePermissions.fromString("rwxr-x---")),
                arguments(0751, PosixFilePermissions.fromString("rwxr-x--x")),
                arguments(0752, PosixFilePermissions.fromString("rwxr-x-w-")),
                arguments(0753, PosixFilePermissions.fromString("rwxr-x-wx")),
                arguments(0754, PosixFilePermissions.fromString("rwxr-xr--")),
                arguments(0755, PosixFilePermissions.fromString("rwxr-xr-x")),
                arguments(0756, PosixFilePermissions.fromString("rwxr-xrw-")),
                arguments(0757, PosixFilePermissions.fromString("rwxr-xrwx")),
                arguments(0760, PosixFilePermissions.fromString("rwxrw----")),
                arguments(0761, PosixFilePermissions.fromString("rwxrw---x")),
                arguments(0762, PosixFilePermissions.fromString("rwxrw--w-")),
                arguments(0763, PosixFilePermissions.fromString("rwxrw--wx")),
                arguments(0764, PosixFilePermissions.fromString("rwxrw-r--")),
                arguments(0765, PosixFilePermissions.fromString("rwxrw-r-x")),
                arguments(0766, PosixFilePermissions.fromString("rwxrw-rw-")),
                arguments(0767, PosixFilePermissions.fromString("rwxrw-rwx")),
                arguments(0770, PosixFilePermissions.fromString("rwxrwx---")),
                arguments(0771, PosixFilePermissions.fromString("rwxrwx--x")),
                arguments(0772, PosixFilePermissions.fromString("rwxrwx-w-")),
                arguments(0773, PosixFilePermissions.fromString("rwxrwx-wx")),
                arguments(0774, PosixFilePermissions.fromString("rwxrwxr--")),
                arguments(0775, PosixFilePermissions.fromString("rwxrwxr-x")),
                arguments(0776, PosixFilePermissions.fromString("rwxrwxrw-")),
                arguments(0777, PosixFilePermissions.fromString("rwxrwxrwx")),
                arguments(01000, PosixFilePermissions.fromString("---------")),
                arguments(-1, PosixFilePermissions.fromString("rwxrwxrwx")),
        };
        return Arrays.stream(arguments);
    }

    @ParameterizedTest(name = "mask: {0}, permissions: {1}")
    @MethodSource("testArguments")
    void testFromMask(int mask, Set<PosixFilePermission> permissions) {
        assertEquals(permissions, PosixFilePermissionSupport.fromMask(mask));
    }

    @ParameterizedTest(name = "mask: {0}, permissions: {1}")
    @MethodSource("testArguments")
    void testToMask(int mask, Set<PosixFilePermission> permissions) {
        // don't test toMask for 01000 or -1
        if (0 <= mask && mask <= 0777) {
            assertEquals(mask, PosixFilePermissionSupport.toMask(permissions));
        }
    }

    @ParameterizedTest(name = "mask: {0}, permissions: {1}")
    @MethodSource("testArguments")
    void testHasPermission(int mask, Set<PosixFilePermission> permissions) {
        for (PosixFilePermission permission : ALL_PERMISSIONS) {
            assertEquals(permissions.contains(permission), PosixFilePermissionSupport.hasPermission(mask, permission));
        }
    }
}
